(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["serial-nav-app","serial-base"],{9091:function(e,t,r){"use strict";r.r(t);r("4de4"),r("7db0"),r("d81d"),r("b0c0"),r("a9e3"),r("d3b7"),r("3ca3"),r("ddb0"),r("96cf");var n=r("1da1"),a=r("d4ec"),i=r("bee2"),u=r("262e"),c=r("2caf"),s=r("faa1"),o=r.n(s),h=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(a["a"])(this,r),e=t.call(this),e.requestRequired=!1,e.mute=!1,e.baud=Number(window.localStorage.currentBaudRate)||115200,e.lastBaud=115200,e.encoding="ascii",e.devices=[],e.currentDevice=null,e.connected=!1,e.implementation="basic",e}return Object(i["a"])(r,[{key:"install",value:function(e){e.$serial=this,e.prototype.$serial=this}},{key:"requestDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"listDevices",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.devices.map((function(e){return r.isDevice(e.value)})));case 2:return t=e.sent,e.abrupt("return",this.devices.filter((function(e,r){return t[r]})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setCurrentDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.currentDevice=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setBaud",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.disconnect();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:return this.lastBaud=this.baud,this.baud=t,e.next=12,this.connect();case 12:return window.localStorage.currentBaudRate=t,e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"resetBaud",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.setBaud(this.lastBaud);case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setMute",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.mute=t;case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_transSignal",value:function(e){return"on"===e||!0===e?{dtr:!0,rts:!0,dataTerminalReady:!0,requestToSend:!0}:"off"===e||!1===e?{dtr:!1,rts:!1,dataTerminalReady:!1,requestToSend:!1}:e}},{key:"setSignals",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"write",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeBuff",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"connect",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.connected=!0;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"disconnect",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.connected=!1;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setDeviceName",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.isDevice(t);case 2:if(!e.sent){e.next=4;break}this.devices.push({value:t,name:r});case 4:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getDeviceName",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.devices.find((function(e){return e.value===t}))||{name:""}).name);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(o.a);t["default"]=h},be9f:function(e,t,r){"use strict";r.r(t),function(e){r("d3b7"),r("25f0"),r("96cf");var n=r("1da1"),a=r("d4ec"),i=r("bee2"),u=r("262e"),c=r("2caf"),s=r("2b0e"),o=r("9091"),h=navigator,p=h.serial,l=function(e){return new Promise((function(t){return setTimeout(t,e)}))};console.log("using navserial");var f=function(t){Object(u["a"])(o,t);var r=Object(c["a"])(o);function o(){var e;return Object(a["a"])(this,o),e=r.call(this),e.requestRequired=!0,e.devices=JSON.parse(localStorage.portNames||"[]"),e._currentDevice=null,e._rl=!1,e._reader=null,e.implementation="navserial",e.handlesSelect=!0,e}return Object(i["a"])(o,[{key:"_getDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_readLoop",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var n,a,i,u=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this._rl&&r===this._rl){t.next=2;break}return t.abrupt("return");case 2:if(this._currentDevice&&this._currentDevice.readable){t.next=5;break}return this._rl=!1,t.abrupt("return");case 5:t.prev=5,this._reader=this._currentDevice.readable.getReader();case 7:if(r!==this._rl){t.next=20;break}return t.next=10,this._reader.read();case 10:if(n=t.sent,a=n.value,i=n.done,!i){t.next=16;break}return this._reader.releaseLock(),t.abrupt("break",20);case 16:this.emit("data",e.from(a)),this.mute||this.emit("message",e.from(a).toString(this.encoding)),t.next=7;break;case 20:t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](5),this.emit("message","<ERROR: ".concat(t.t0.message,">"));case 25:this._reader&&this._reader.releaseLock(),this._reader=null,setTimeout((function(){return u._readLoop(r)}),10);case 28:case"end":return t.stop()}}),t,this,[[5,22]])})));function r(e){return t.apply(this,arguments)}return r}()},{key:"stopReadLoop",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._rl=!1,!this._reader){e.next=7;break}return this._reader.cancel(),e.next=5,l(100);case 5:return e.next=7,this.stopReadLoop();case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"requestDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p.requestPort({classCode:2});case 2:t=e.sent,this.setCurrentDevice(t);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._getDevice(t);case 2:return e.abrupt("return",!!e.sent);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setCurrentDevice",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.isDevice(t);case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:return this.connected&&this.disconnect(),e.next=7,this._getDevice(t);case 7:return this._currentDevice=e.sent,s["default"].set(this,"currentDevice",t),this.emit("currentDevice",t),e.prev=10,e.next=13,this.connect();case 13:e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](10),"Access denied."===e.t0.message&&this.emit("errorPrompt","access_denied"),console.error([e.t0]);case 19:case"end":return e.stop()}}),e,this,[[10,15]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeBuff",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=this._currentDevice.writable.getWriter(),e.next=3,r.write(t);case 3:return e.next=5,r.releaseLock();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"write",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.mute){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.writeBuff(e.from(r,this.encoding));case 4:case"end":return t.stop()}}),t,this)})));function r(e){return t.apply(this,arguments)}return r}()},{key:"connect",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._currentDevice){e.next=2;break}return e.abrupt("return");case 2:if(!this._currentDevice.readable){e.next=11;break}return e.prev=3,e.next=6,this.disconnect();case 6:e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](3),console.error(e.t0);case 11:return e.next=13,this._currentDevice.open({baudrate:this.baud,baudRate:this.baud});case 13:this.connected=!0,this.emit("connected",this.currentDevice),this._rl=Math.random(),this._readLoop(this._rl);case 17:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"disconnect",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this._currentDevice){e.next=2;break}return e.abrupt("return");case 2:if(!this._rl){e.next=5;break}return e.next=5,this.stopReadLoop();case 5:return e.next=7,l(100);case 7:return e.next=9,this._currentDevice.close();case 9:return e.next=11,l(100);case 11:this.connected=!1,this.emit("disconnect",this.currentDevice),console.log("disconnected");case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"setDeviceName",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.isDevice(t);case 2:if(e.sent){e.next=4;break}return e.abrupt("return");case 4:this.devices.push({value:t,name:r}),localStorage.portNames=JSON.stringify(this.devices),this.setCurrentDevice(t);case 7:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"setSignals",value:function(e){if(!this._currentDevice)throw new Error("Cannot write to closed port.");var t=this._transSignal(e);return this._currentDevice.setSignals(t)}}]),o}(o["default"]);t["default"]=f}.call(this,r("b639").Buffer)}}]);
//# sourceMappingURL=serial-nav-app.8b6d4159.js.map